<app-header [inModule]="true" title="Estadísticas" (exitEvent)="exit()"></app-header>
<ion-content *ngIf="dataInitialized">
  <div class="p-3 h-full w-full">
    <ion-toolbar class="bg-gray-300 rounded-sm mb-2" color="light">
      <ion-segment [value]="dateFilter" (ionChange)="changeDateFilter($event)">
        <ion-segment-button value="month">
          Mes
        </ion-segment-button>
        <ion-segment-button value="year">
          Año
        </ion-segment-button>
        <ion-segment-button value="total">
          Total
        </ion-segment-button>
      </ion-segment>
    </ion-toolbar>
    <div  *ngIf="dateFilter && dateFilter !=='total'" class="w-full date-filter-container">
      <datepicker-views-selection [displayDateFormat]="dateFilter" [placeholder]="datePlaceholder" (onYearChange)="onYearSelected($event)" (onMonthChange)="onMonthSelected($event)"></datepicker-views-selection>
    </div>
    <div class="rounded-sm shadow-md">
      <div class="title-container border-b-2 flex flex-column">
        <h1 class="font-bold" style="font-size:24px">Compresores Instalados: {{currentRecordLength}}</h1>
        <div class="w-full">
          <p class="font-md">Filtro
            <span *ngIf="dateFilter !=='total'"> Desde: {{filterData.compareDateBiggerThan | date: dateFormat}}</span> - <span *ngIf="dateFilter !=='total'">Hasta: {{filterData.compareDateLesserThan | date: dateFormat}}</span>
            <span *ngIf="dateFilter ==='total'">Hasta hoy: {{filterData.compareDateLesserThan | date: dateFormat }}</span>
          </p>
        </div>
        
      </div>
      <!-- CHART COMPONENT -->
        <div style="display: block" class="mt-2">
          <canvas baseChart height="200"
            [data]="dataset"
            [options]="chartOptionsValue"
            [plugins]="chartPlugins"
            [type]="chartType"
            >
          </canvas>
        </div>
    </div>
    <div class="mt-3" [formGroup]="filterForm">
      <app-select-field label="Opciones de filtro" formControlName="filter" [optionList]="selectOptions"></app-select-field>
    </div>
  </div>
</ion-content>